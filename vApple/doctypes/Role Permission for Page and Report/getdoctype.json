{"docs":[{"fields":[{"collapsible":0,"no_copy":0,"creation":"2017-02-13 17:33:25.157332","search_fields":null,"doctype":"DocField","owner":"Administrator","in_list_view":0,"reqd":1,"ignore_xss_filter":0,"in_global_search":0,"read_only":0,"print_hide":0,"modified_by":"Administrator","ignore_user_permissions":0,"length":0,"label":"Set Role For","print_hide_if_no_value":0,"allow_bulk_edit":0,"linked_document_type":null,"set_only_once":0,"docstatus":0,"hidden":0,"in_filter":0,"permlevel":0,"columns":0,"bold":0,"parent":"Role Permission for Page and Report","search_index":0,"allow_on_submit":0,"precision":"","is_custom_field":null,"remember_last_selected_value":0,"unique":0,"name":"835718837f","idx":1,"in_standard_filter":0,"modified":"2017-06-09 23:47:39.094704","parenttype":"DocType","fieldname":"set_role_for","fieldtype":"Select","options":"\nPage\nReport","report_hide":0,"parentfield":"fields"},{"collapsible":0,"no_copy":0,"creation":"2017-02-13 17:33:25.157332","search_fields":null,"doctype":"DocField","owner":"Administrator","in_list_view":0,"reqd":0,"ignore_xss_filter":0,"in_global_search":0,"read_only":0,"print_hide":0,"modified_by":"Administrator","ignore_user_permissions":0,"length":0,"label":"Page","print_hide_if_no_value":0,"allow_bulk_edit":0,"linked_document_type":"System","set_only_once":0,"depends_on":"eval:doc.set_role_for == 'Page'","docstatus":0,"hidden":0,"in_filter":0,"permlevel":0,"columns":0,"bold":0,"parent":"Role Permission for Page and Report","search_index":0,"allow_on_submit":0,"precision":"","is_custom_field":null,"remember_last_selected_value":0,"unique":0,"name":"83ce5159c5","idx":2,"in_standard_filter":0,"modified":"2017-06-09 23:47:39.094704","parenttype":"DocType","fieldname":"page","fieldtype":"Link","options":"Page","report_hide":0,"parentfield":"fields"},{"collapsible":0,"no_copy":0,"creation":"2017-02-13 17:33:25.157332","search_fields":null,"doctype":"DocField","owner":"Administrator","in_list_view":0,"reqd":0,"ignore_xss_filter":0,"in_global_search":0,"read_only":0,"print_hide":0,"modified_by":"Administrator","ignore_user_permissions":0,"length":0,"label":"Report","print_hide_if_no_value":0,"allow_bulk_edit":0,"linked_document_type":"System","set_only_once":0,"depends_on":"eval:doc.set_role_for == 'Report'","docstatus":0,"hidden":0,"in_filter":0,"permlevel":0,"columns":0,"bold":0,"parent":"Role Permission for Page and Report","search_index":0,"allow_on_submit":0,"precision":"","is_custom_field":null,"remember_last_selected_value":0,"unique":0,"name":"045e518f45","idx":3,"in_standard_filter":0,"modified":"2017-06-09 23:47:39.094704","parenttype":"DocType","fieldname":"report","fieldtype":"Link","options":"Report","report_hide":0,"parentfield":"fields"},{"collapsible":0,"no_copy":0,"creation":"2017-02-13 17:33:25.157332","search_fields":null,"doctype":"DocField","owner":"Administrator","in_list_view":0,"reqd":0,"ignore_xss_filter":0,"in_global_search":0,"read_only":0,"print_hide":0,"modified_by":"Administrator","ignore_user_permissions":0,"length":0,"label":"Allow Roles","print_hide_if_no_value":0,"allow_bulk_edit":0,"linked_document_type":null,"set_only_once":0,"docstatus":0,"hidden":0,"in_filter":0,"permlevel":0,"columns":0,"bold":0,"parent":"Role Permission for Page and Report","search_index":0,"allow_on_submit":0,"precision":"","is_custom_field":null,"remember_last_selected_value":0,"unique":0,"name":"d2b74c6e56","idx":4,"in_standard_filter":0,"modified":"2017-06-09 23:47:39.094704","parenttype":"DocType","fieldname":"roles_permission","fieldtype":"Section Break","report_hide":0,"parentfield":"fields"},{"collapsible":0,"no_copy":0,"creation":"2017-02-13 17:33:25.157332","search_fields":null,"doctype":"DocField","owner":"Administrator","in_list_view":0,"reqd":0,"ignore_xss_filter":0,"in_global_search":0,"read_only":0,"print_hide":0,"modified_by":"Administrator","ignore_user_permissions":0,"length":0,"label":"Roles Html","print_hide_if_no_value":0,"allow_bulk_edit":0,"linked_document_type":null,"set_only_once":0,"depends_on":"","docstatus":0,"hidden":0,"in_filter":0,"permlevel":0,"columns":0,"bold":0,"parent":"Role Permission for Page and Report","search_index":0,"allow_on_submit":0,"precision":"","is_custom_field":null,"remember_last_selected_value":0,"unique":0,"name":"b7b5356576","idx":5,"in_standard_filter":0,"modified":"2017-06-09 23:47:39.094704","parenttype":"DocType","fieldname":"roles_html","fieldtype":"HTML","report_hide":0,"parentfield":"fields"},{"collapsible":0,"no_copy":0,"creation":"2017-02-13 17:33:25.157332","search_fields":null,"doctype":"DocField","owner":"Administrator","in_list_view":0,"reqd":0,"ignore_xss_filter":0,"in_global_search":0,"read_only":1,"print_hide":0,"modified_by":"Administrator","ignore_user_permissions":0,"length":0,"label":"Roles","print_hide_if_no_value":0,"allow_bulk_edit":0,"linked_document_type":null,"set_only_once":0,"docstatus":0,"hidden":1,"in_filter":0,"permlevel":0,"columns":0,"bold":0,"parent":"Role Permission for Page and Report","search_index":0,"allow_on_submit":0,"precision":"","is_custom_field":null,"remember_last_selected_value":0,"unique":0,"name":"fe92112726","idx":6,"in_standard_filter":0,"modified":"2017-06-09 23:47:39.094704","parenttype":"DocType","fieldname":"roles","fieldtype":"Table","options":"Has Role","report_hide":0,"parentfield":"fields"}],"image_view":0,"allow_import":0,"creation":"2017-02-13 17:33:25.157332","__list_js":null,"track_changes":0,"track_seen":0,"sort_order":"DESC","__linked_with":null,"owner":"Administrator","editable_grid":1,"__form_grid_templates":null,"in_create":0,"read_only":0,"__templates":null,"document_type":"","hide_heading":0,"modified_by":"Administrator","allow_rename":0,"__kanban_column_fields":[],"custom":0,"max_attachments":0,"__js":"\n\n/* Adding /home/frappe/frappe-bench/apps/frappe/frappe/core/doctype/role_permission_for_page_and_report/role_permission_for_page_and_report.js */\n\n// Copyright (c) 2016, Frappe Technologies and contributors\n// For license information, please see license.txt\n\nfrappe.ui.form.on('Role Permission for Page and Report', {\n\tsetup: function(frm) {\n\t\tfrm.trigger(\"set_queries\")\n\t},\n\n\trefresh: function(frm) {\n\t\tfrm.disable_save();\n\t\tfrm.role_area.hide();\n\t\tfrm.add_custom_button(__(\"Reset to defaults\"),\n\t\t\tfunction(){ frm.trigger(\"reset_roles\") });\n\t\tfrm.add_custom_button(__(\"Update\"),\n\t\t\tfunction(){ frm.trigger(\"update_roles\") }).addClass('btn-primary');\n\t},\n\t\n\tonload: function(frm) {\n\t\tif(!frm.roles_editor) {\n\t\t\tfrm.role_area = $('<div style=\"min-height: 300px\">')\n\t\t\t\t.appendTo(frm.fields_dict.roles_html.wrapper);\n\t\t\tfrm.roles_editor = new frappe.RoleEditor(frm.role_area, frm);\n\t\t}\n\t},\n\n\tset_queries: function(frm) {\n\t\tfrm.set_query(\"page\", function() {\n\t\t\treturn {\n\t\t\t\tfilters: {\n\t\t\t\t\tsystem_page: 0\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t},\n\n\tset_role_for: function(frm) {\n\t\tfrm.trigger(\"clear_fields\")\n\t\tfrm.toggle_display('roles_html', false)\n\t},\n\n\tclear_fields: function(frm) {\n\t\tvar field = (frm.doc.set_role_for == 'Report') ? 'page' : 'report';\n\t\tfrm.set_value(field, '');\n\t},\n\n\tpage: function(frm) {\n\t\tif(frm.doc.page) {\n\t\t\tfrm.trigger(\"get_roles\")\n\t\t}\n\t},\n\n\treport: function(frm){\n\t\tif(frm.doc.report) {\n\t\t\tfrm.trigger(\"get_roles\")\n\t\t}\n\t},\n\n\tget_roles: function(frm) {\n\t\tfrm.toggle_display('roles_html', true)\n\t\tfrm.role_area.show();\n\n\t\treturn frm.call({\n\t\t\tmethod:\"get_custom_roles\",\n\t\t\tdoc: frm.doc,\n\t\t\tcallback: function(r) {\n\t\t\t\trefresh_field('roles')\n\t\t\t\tfrm.roles_editor.show()\n\t\t\t}\n\t\t})\n\t},\n\n\tupdate_roles: function(frm) {\n\t\tfrm.trigger(\"validate_mandatory_fields\")\n\t\tif(frm.roles_editor) {\n\t\t\tfrm.roles_editor.set_roles_in_table()\n\t\t}\n\n\t\treturn frm.call({\n\t\t\tmethod:\"set_custom_roles\",\n\t\t\tdoc: frm.doc,\n\t\t\tcallback: function(r) {\n\t\t\t\trefresh_field('roles')\n\t\t\t\tfrm.roles_editor.show()\n\t\t\t\tfrappe.msgprint(__(\"Successfully Updated\"))\n\t\t\t}\n\t\t})\n\t},\n\n\treset_roles: function(frm) {\n\t\tfrm.trigger(\"validate_mandatory_fields\")\n\t\treturn frm.call({\n\t\t\tmethod:\"reset_roles\",\n\t\t\tdoc: frm.doc,\n\t\t\tcallback: function(r) {\n\t\t\t\trefresh_field('roles')\n\t\t\t\tfrm.roles_editor.show()\n\t\t\t\tfrappe.msgprint(__(\"Successfully Updated\"))\n\t\t\t}\n\t\t})\n\t},\n\n\tvalidate_mandatory_fields: function(frm) {\n\t\tif(!frm.doc.set_role_for){\n\t\t\tfrappe.throw(__(\"Mandatory field: set role for\"))\n\t\t}\n\t\t\n\t\tif(frm.doc.set_role_for && !frm.doc[frm.doc.set_role_for.toLocaleLowerCase()]) {\n\t\t\tfrappe.throw(__(\"Mandatory field: {0}\", [frm.doc.set_role_for]))\n\t\t}\n\t}\n});\n","__tree_js":null,"docstatus":0,"sort_field":"modified","__messages":null,"allow_copy":1,"engine":"InnoDB","allow_guest_to_view":0,"istable":0,"has_web_view":0,"__map_js":null,"__css":null,"show_name_in_global_search":0,"beta":0,"read_only_onload":0,"module":"Core","doctype":"DocType","__dashboard":{},"__kanban_boards":[],"issingle":1,"__listview_template":null,"name":"Role Permission for Page and Report","idx":0,"hide_toolbar":1,"__workflow_docs":[],"modified":"2017-03-11 02:35:32.369043","is_submittable":0,"name_case":"","__calendar_js":null,"permissions":[{"creation":"2017-02-13 17:33:25.157332","share":1,"doctype":"DocPerm","owner":"Administrator","export":0,"cancel":0,"set_user_permissions":0,"modified_by":"Administrator","create":1,"submit":0,"write":1,"role":"System Manager","print":1,"docstatus":0,"permlevel":0,"parent":"Role Permission for Page and Report","read":1,"import":0,"report":0,"apply_user_permissions":0,"name":"ced33b4b54","idx":1,"amend":0,"modified":"2017-06-09 23:47:39.094704","email":1,"parenttype":"DocType","parentfield":"permissions","if_owner":0,"delete":1}],"quick_entry":1,"__custom_js":"","__print_formats":[]},{"fields":[{"collapsible":0,"no_copy":0,"oldfieldtype":"Link","creation":"2013-02-22 01:27:34","search_fields":null,"doctype":"DocField","oldfieldname":"role","owner":"Administrator","in_list_view":1,"reqd":0,"ignore_xss_filter":0,"in_global_search":0,"read_only":0,"print_hide":0,"modified_by":"Administrator","ignore_user_permissions":0,"length":0,"label":"Role","print_hide_if_no_value":0,"allow_bulk_edit":0,"linked_document_type":"Document","set_only_once":0,"docstatus":0,"hidden":0,"in_filter":0,"permlevel":0,"columns":0,"bold":0,"parent":"Has Role","search_index":0,"allow_on_submit":0,"is_custom_field":null,"remember_last_selected_value":0,"unique":0,"name":"9f848f7a91","idx":1,"in_standard_filter":0,"modified":"2017-06-09 23:47:35.873262","parenttype":"DocType","fieldname":"role","fieldtype":"Link","options":"Role","report_hide":0,"parentfield":"fields"}],"image_view":0,"allow_import":0,"creation":"2013-02-22 01:27:34","__list_js":null,"track_changes":0,"track_seen":0,"__calendar_js":null,"__linked_with":null,"__dashboard":null,"owner":"Administrator","editable_grid":1,"__form_grid_templates":null,"in_create":0,"read_only":0,"__templates":null,"__css":null,"hide_heading":0,"modified_by":"Administrator","allow_rename":0,"__kanban_column_fields":null,"custom":0,"max_attachments":0,"__js":null,"__tree_js":null,"docstatus":0,"__messages":null,"allow_copy":0,"allow_guest_to_view":0,"istable":1,"has_web_view":0,"__map_js":null,"show_name_in_global_search":0,"beta":0,"read_only_onload":0,"module":"Core","doctype":"DocType","autoname":"hash","__kanban_boards":null,"issingle":0,"__listview_template":null,"name":"Has Role","idx":1,"hide_toolbar":0,"__workflow_docs":null,"modified":"2017-02-13 14:00:08.116312","is_submittable":0,"permissions":[],"quick_entry":0,"__custom_js":null,"__print_formats":null}],"user_settings":"{}"}