{"message":{"html_format":"<h2 class=\"text-center\">{%= __(\"Statement of Account\") %}</h2>\n<h4 class=\"text-center\">\n\t{% if (filters.party_name) { %}\n\t\t{%= filters.party_name %}\n\t{% } else if (filters.party) { %}\n\t\t{%= filters.party %}\n\t{% } else if (filters.account) { %}\n\t\t{%= filters.account %}\n\t{% } %}\n</h4>\n<h5 class=\"text-center\">\n\t{%= dateutil.str_to_user(filters.from_date) %}\n\t{%= __(\"to\") %}\n\t{%= dateutil.str_to_user(filters.to_date) %}\n</h5>\n<hr>\n<table class=\"table table-bordered\">\n\t<thead>\n\t\t<tr>\n\t\t\t<th style=\"width: 15%\">{%= __(\"Date\") %}</th>\n\t\t\t<th style=\"width: 15%\">{%= __(\"Ref\") %}</th>\n\t\t\t<th style=\"width: 40%\">{%= __(\"Party\") %}</th>\n\t\t\t<th style=\"width: 15%\">{%= __(\"Debit\") %}</th>\n\t\t\t<th style=\"width: 15%\">{%= __(\"Credit\") %}</th>\n\t\t</tr>\n\t</thead>\n\t<tbody>\n\t\t{% for(var i=0, l=data.length; i<l; i++) { %}\n\t\t\t<tr>\n\t\t\t{% if(data[i][__(\"Posting Date\")]) { %}\n\t\t\t\t<td>{%= dateutil.str_to_user(data[i][__(\"Posting Date\")]) %}</td>\n\t\t\t\t<td>{%= data[i][__(\"Voucher Type\")] %}\n\t\t\t\t\t<br>{%= data[i][__(\"Voucher No\")] %}</td>\n\t\t\t\t<td>\n\t\t\t\t\t{% if(!(filters.party || filters.account)) { %}\n\t\t\t\t\t\t{%= data[i][__(\"Party\")] || data[i][__(\"Account\")] %}\n\t\t\t\t\t\t<br>\n\t\t\t\t\t{% } %}\n\n\t\t\t\t\t{{ __(\"Against\") }}: {%= data[i][__(\"Against Account\")] %}\n\t\t\t\t\t<br>{%= __(\"Remarks\") %}: {%= data[i][__(\"Remarks\")] %}</td>\n\t\t\t\t<td style=\"text-align: right\">{%= format_currency(data[i][__(\"Debit\")]) %}</td>\n\t\t\t\t<td style=\"text-align: right\">{%= format_currency(data[i][__(\"Credit\")]) %}</td>\n\t\t\t{% } else { %}\n\t\t\t\t<td></td>\n\t\t\t\t<td></td>\n\t\t\t\t<td><b>{%= frappe.format(data[i][__(\"Account\")], {fieldtype: \"Link\"}) || \"&nbsp;\" %}</b></td>\n\t\t\t\t<td style=\"text-align: right\">\n\t\t\t\t\t{%= data[i][__(\"Account\")] && format_currency(data[i][__(\"Debit\")]) %}</td>\n\t\t\t\t<td style=\"text-align: right\">\n\t\t\t\t\t{%= data[i][__(\"Account\")] && format_currency(data[i][__(\"Credit\")]) %}</td>\n\t\t\t{% } %}\n\t\t\t</tr>\n\t\t{% } %}\n\t</tbody>\n</table>\n<p class=\"text-right text-muted\">Printed On {%= dateutil.str_to_user(dateutil.get_datetime_as_string()) %}</p>\n","script":"// Copyright (c) 2015, Frappe Technologies Pvt. Ltd. and Contributors\n// License: GNU General Public License v3. See license.txt\n\nfrappe.query_reports[\"General Ledger\"] = {\n\t\"filters\": [\n\t\t{\n\t\t\t\"fieldname\":\"company\",\n\t\t\t\"label\": __(\"Company\"),\n\t\t\t\"fieldtype\": \"Link\",\n\t\t\t\"options\": \"Company\",\n\t\t\t\"default\": frappe.defaults.get_user_default(\"Company\"),\n\t\t\t\"reqd\": 1\n\t\t},\n\t\t{\n\t\t\t\"fieldname\":\"from_date\",\n\t\t\t\"label\": __(\"From Date\"),\n\t\t\t\"fieldtype\": \"Date\",\n\t\t\t\"default\": frappe.datetime.add_months(frappe.datetime.get_today(), -1),\n\t\t\t\"reqd\": 1,\n\t\t\t\"width\": \"60px\"\n\t\t},\n\t\t{\n\t\t\t\"fieldname\":\"to_date\",\n\t\t\t\"label\": __(\"To Date\"),\n\t\t\t\"fieldtype\": \"Date\",\n\t\t\t\"default\": frappe.datetime.get_today(),\n\t\t\t\"reqd\": 1,\n\t\t\t\"width\": \"60px\"\n\t\t},\n\t\t{\n\t\t\t\"fieldname\":\"account\",\n\t\t\t\"label\": __(\"Account\"),\n\t\t\t\"fieldtype\": \"Link\",\n\t\t\t\"options\": \"Account\",\n\t\t\t\"get_query\": function() {\n\t\t\t\tvar company = frappe.query_report_filters_by_name.company.get_value();\n\t\t\t\treturn {\n\t\t\t\t\t\"doctype\": \"Account\",\n\t\t\t\t\t\"filters\": {\n\t\t\t\t\t\t\"company\": company,\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\t{\n\t\t\t\"fieldname\":\"voucher_no\",\n\t\t\t\"label\": __(\"Voucher No\"),\n\t\t\t\"fieldtype\": \"Data\",\n\t\t},\n\t\t{\n\t\t\t\"fieldname\":\"project\",\n\t\t\t\"label\": __(\"Project\"),\n\t\t\t\"fieldtype\": \"Link\",\n\t\t\t\"options\": \"Project\"\n\t\t},\n\t\t{\n\t\t\t\"fieldtype\": \"Break\",\n\t\t},\n\t\t{\n\t\t\t\"fieldname\":\"party_type\",\n\t\t\t\"label\": __(\"Party Type\"),\n\t\t\t\"fieldtype\": \"Link\",\n\t\t\t\"options\": \"Party Type\",\n\t\t\t\"default\": \"\"\n\t\t},\n\t\t{\n\t\t\t\"fieldname\":\"party\",\n\t\t\t\"label\": __(\"Party\"),\n\t\t\t\"fieldtype\": \"Dynamic Link\",\n\t\t\t\"get_options\": function() {\n\t\t\t\tvar party_type = frappe.query_report_filters_by_name.party_type.get_value();\n\t\t\t\tvar party = frappe.query_report_filters_by_name.party.get_value();\n\t\t\t\tif(party && !party_type) {\n\t\t\t\t\tfrappe.throw(__(\"Please select Party Type first\"));\n\t\t\t\t}\n\t\t\t\treturn party_type;\n\t\t\t},\n\t\t\ton_change: function() {\n\t\t\t\tvar party_type = frappe.query_report_filters_by_name.party_type.get_value();\n\t\t\t\tvar party = frappe.query_report_filters_by_name.party.get_value();\n\t\t\t\tif(!party_type || !party) {\n\t\t\t\t\tfrappe.query_report_filters_by_name.party_name.set_value(\"\");\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tvar fieldname = party_type.toLowerCase() + \"_name\";\n\t\t\t\tfrappe.db.get_value(party_type, party, fieldname, function(value) {\n\t\t\t\t\tfrappe.query_report_filters_by_name.party_name.set_value(value[fieldname]);\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\t\t{\n\t\t\t\"fieldname\":\"party_name\",\n\t\t\t\"label\": __(\"Party Name\"),\n\t\t\t\"fieldtype\": \"Data\",\n\t\t\t\"hidden\": 1\n\t\t},\n\t\t{\n\t\t\t\"fieldname\":\"group_by_voucher\",\n\t\t\t\"label\": __(\"Group by Voucher\"),\n\t\t\t\"fieldtype\": \"Check\",\n\t\t\t\"default\": 1\n\t\t},\n\t\t{\n\t\t\t\"fieldname\":\"group_by_account\",\n\t\t\t\"label\": __(\"Group by Account\"),\n\t\t\t\"fieldtype\": \"Check\",\n\t\t}\n\t]\n}\n"}}