{"docs":[{"system_page":0,"parent":null,"creation":"2015-02-18 05:17:17.301735","_dynamic_page":1,"module":"Hub Node","standard":"Yes","doctype":"Page","owner":"Administrator","icon":null,"style":null,"modified_by":"Administrator","name":"hub","roles":[{"modified_by":"Administrator","name":null,"parent":"hub","creation":"2015-02-18 05:17:17.301735","modified":"2017-06-09 23:52:09.488167","doctype":"Has Role","idx":1,"parenttype":"Page","role":"All","owner":"Administrator","docstatus":0,"parentfield":"roles"}],"script":"frappe.templates[\"hub_body\"] = '<div class=\"padding\"> <div class=\"row\"> <div class=\"col-md-4 col-md-offset-4\"> <input class=\"form-control\" name=\"search\" placeholder=\"{%= __(\"Search\") %}\"> </div> </div> <hr style=\"margin: 15px -15px\"> <div class=\"hub-list\"> </div> <div class=\"loading\"> <p class=\"text-muted text-center\">{%= __(\"Loading...\") %}</p> </div> <div class=\"more text-center hide\"> <button class=\"btn btn-default btn-sm\">{%= __(\"More\") %}</div> </div> <div class=\"done text-center text-extra-muted hide\"> <p>{%= __(\"No more results.\") %}</p> </div> </div> ';\nfrappe.templates[\"register_in_hub\"] = '<div style=\"padding: 70px 0px;\"> <h2 class=\"text-center\">{%= __(\"Register For ERPNext Hub\") %}</h2> <br> <div class=\"row\"> <div class=\"col-md-6 col-md-offset-3\"> <ul> <li>Free listing of your products</li> <li>Let other ERPNext users discover your products</li> <li>Discover products quickly</li> <li>Automate workflow with Supplier from within ERPNext (later)</li> </ul> </div> </div> <br> <div class=\"text-center\"> <a class=\"btn btn-primary\" href=\"#Form/Hub Settings\"> Hub Settings</a> </div> </div> ';\nfrappe.templates[\"hub_list\"] = '{% for(var i=0, l=items.length; i < l; i++) { %} <div class=\"list-item\"> <div class=\"row\"> <div class=\"col-sm-6\"> <h6>{%= items[i].item_name %}<h6> </div> <div class=\"col-sm-3\"> <h6>{%= items[i].seller_name %}<h6> </div> <div class=\"col-sm-3 text-right\"> <h6 class=\"text-muted\">{%= items[i].seller_country %}<h6> </div> </div> <p class=\"text-muted small\">{%= items[i].description %}</p> </div> {% } %} ';\nfrappe.pages['hub'].on_page_load = function(wrapper) {\n\tvar page = frappe.ui.make_app_page({\n\t\tparent: wrapper,\n\t\ttitle: 'Hub',\n\t\tsingle_column: true\n\t});\n\n\tfrappe.hub = new frappe.Hub({page:page});\n\n}\n\nfrappe.pages['hub'].on_page_show = function() {\n\tfrappe.hub.refresh();\n}\n\nfrappe.Hub = Class.extend({\n\tinit: function(args) {\n\t\t$.extend(this, args);\n\t\tthis.render();\n\t},\n\trefresh: function() {\n\t\tif(this.hub && this.hub.publish && !this.hub_list) {\n\t\t\tthis.setup_list();\n\t\t}\n\t},\n\trender: function() {\n\t\tthis.page.main.empty();\n\t\tvar me = this;\n\t\tfrappe.model.with_doc(\"Hub Settings\", \"Hub Settings\", function() {\n\t\t\tme.hub = locals[\"Hub Settings\"][\"Hub Settings\"];\n\t\t\tif(!me.hub.publish) {\n\t\t\t\t$(frappe.render_template(\"register_in_hub\", {})).appendTo(me.page.main);\n\t\t\t} else {\n\t\t\t\tme.setup_list();\n\t\t\t}\n\t\t});\n\t},\n\tsetup_list: function() {\n\t\tvar me = this;\n\t\t$(frappe.render_template(\"hub_body\", {})).appendTo(this.page.main);\n\t\tthis.hub_list = this.page.main.find(\".hub-list\");\n\t\tthis.search = this.page.main.find(\"input\").on(\"keypress\", function(e) {\n\t\t\tif(e.which===13) {\n\t\t\t\tme.reset();\n\t\t\t}\n\t\t});\n\t\tthis.loading = this.page.main.find(\".loading\");\n\t\tthis.done = this.page.main.find(\".done\");\n\t\tthis.more = this.page.main.find(\".more\")\n\t\tthis.more.find(\".btn\").on(\"click\", function() { me.next_page() });\n\t\tthis.reset();\n\t},\n\treset: function() {\n\t\tthis.hub_list.empty();\n\t\tthis.start = 0;\n\t\tthis.page_length = 20;\n\t\tthis.next_page();\n\t},\n\tnext_page: function() {\n\t\tvar me = this;\n\t\tthis.loading.toggleClass(\"hide\", false);\n\t\tfrappe.call({\n\t\t\tmethod: \"erpnext.hub_node.get_items\",\n\t\t\targs: {\n\t\t\t\ttext: this.get_text(),\n\t\t\t\tstart: this.start,\n\t\t\t\tlimit: this.page_length\n\t\t\t},\n\t\t\tcallback: function(r) {\n\t\t\t\tme.loading.toggleClass(\"hide\", true);\n\t\t\t\tif(!r.message)\n\t\t\t\t\tr.message = [];\n\t\t\t\tme.start += r.message.length;\n\t\t\t\t$(frappe.render_template(\"hub_list\", {items: r.message})).appendTo(me.hub_list);\n\t\t\t\tif(r.message.length && r.message.length===me.page_length) {\n\t\t\t\t\t// more\n\t\t\t\t\tme.more.removeClass(\"hide\");\n\t\t\t\t\tme.done.addClass(\"hide\");\n\t\t\t\t} else {\n\t\t\t\t\t// done\n\t\t\t\t\tme.more.addClass(\"hide\");\n\t\t\t\t\tme.done.removeClass(\"hide\");\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t},\n\tget_text: function() {\n\t\treturn this.search.val();\n\t},\n})\n","title":"Hub","restrict_to_domain":null,"modified":"2015-02-18 05:17:17.301735","content":null,"idx":0,"parenttype":null,"page_name":"hub","docstatus":0,"parentfield":null}]}