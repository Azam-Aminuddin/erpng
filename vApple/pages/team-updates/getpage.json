{"docs":[{"system_page":0,"parent":null,"creation":"2017-01-31 11:02:31.614045","_dynamic_page":1,"module":"HR","standard":"Yes","doctype":"Page","owner":"Administrator","icon":null,"style":".date-indicator {\n    background:none;\n    font-size:12px;\n    vertical-align:middle;\n    font-weight:bold;\n    color:#6c7680;\n}\n.date-indicator::after {\n    margin:0 -4px 0 12px;\n    content:'';\n    display:inline-block;\n    height:8px;\n    width:8px;\n    border-radius:8px;\n\tbackground: #d1d8dd;\n}\n\n.date-indicator.blue {\n\tcolor: #5e64ff;\n}\n\n.date-indicator.blue::after {\n\tbackground: #5e64ff;\n}\n\n.activity-row {\n}\n\n.activity-message {\n\tborder-left: 1px solid #d1d8dd;\n}\n\n.activity-message .row {\n\tpadding: 15px;\n\tmargin-right: 0px;\n\tborder-bottom: 1px solid #d1d8dd;\n}\n\n.activity-row:last-child .activity-message .row {\n\tborder-bottom: none;\n}\n\n.activity-row .content {\n\tpadding-left: 0px;\n\tpadding-right: 30px;\n}\n\n.activity-date {\n\tpadding: 15px;\n\tpadding-right: 0px;\n\tz-index: 1;\n}\n\n.for-more {\n\tborder-top: 1px solid #d1d8dd;\n\tpadding: 10px;\n}\n","modified_by":"Administrator","name":"team-updates","roles":[{"modified_by":"Administrator","name":null,"parent":"team-updates","creation":"2017-01-31 11:02:31.614045","modified":"2017-06-09 23:52:00.586391","doctype":"Has Role","idx":1,"parenttype":"Page","role":"Employee","owner":"Administrator","docstatus":0,"parentfield":"roles"},{"modified_by":"Administrator","name":null,"parent":"team-updates","creation":"2017-01-31 11:02:31.614045","modified":"2017-06-09 23:52:00.586391","doctype":"Has Role","idx":2,"parenttype":"Page","role":"System Manager","owner":"Administrator","docstatus":0,"parentfield":"roles"}],"script":"frappe.templates[\"team_update_row\"] = '<div class=\"row activity-row\" data-creation=\"{%= creation.split(\" \")[0] + \" 00:00:00\" %}\"> <div class=\"col-xs-3 text-right activity-date\"><span class=\"{%= date_class %}\"> {%= date_sep || \"\" %}</span></div> <div class=\"col-xs-9 activity-message\" title=\"{%= by %} / {%= dateutil.str_to_user(creation) %}\"> <div class=\"row\"> <div class=\"col-xs-2 col-sm-1\"> {{ avatar }} </div> <div class=\"col-xs-10 col-sm-11 small content\"> {{ content }} </div> </div> </div> </div> ';\nfrappe.pages['team-updates'].on_page_load = function(wrapper) {\n\tvar page = frappe.ui.make_app_page({\n\t\tparent: wrapper,\n\t\ttitle: __('Team Updates'),\n\t\tsingle_column: true\n\t});\n\n\tfrappe.team_updates.make(page);\n\tfrappe.team_updates.run();\n\n\tif(frappe.model.can_read('Daily Work Summary Settings')) {\n\t\tpage.add_menu_item(__('Daily Work Summary Settings'), function() {\n\t\t\tfrappe.set_route('Form', 'Daily Work Summary Settings');\n\t\t});\n\t}\n}\n\nfrappe.team_updates = {\n\tstart: 0,\n\tmake: function(page) {\n\t\tvar me = frappe.team_updates;\n\t\tme.page = page;\n\t\tme.body = $('<div></div>').appendTo(me.page.main);\n\t\tme.more = $('<div class=\"for-more\"><button class=\"btn btn-sm btn-default btn-more\">'\n\t\t\t+ __(\"More\") + '</button></div>').appendTo(me.page.main)\n\t\t\t.find('.btn-more').on('click', function() {\n\t\t\t\tme.start += 40;\n\t\t\t\tme.run();\n\t\t\t});\n\t},\n\trun: function() {\n\t\tvar me = frappe.team_updates;\n\t\tfrappe.call({\n\t\t\tmethod: 'erpnext.hr.page.team_updates.team_updates.get_data',\n\t\t\targs: {\n\t\t\t\tstart: me.start\n\t\t\t},\n\t\t\tcallback: function(r) {\n\t\t\t\tif(r.message) {\n\t\t\t\t\tr.message.forEach(function(d) {\n\t\t\t\t\t\tme.add_row(d);\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tfrappe.show_alert({message:__('No more updates'), indicator:'darkgrey'});\n\t\t\t\t\tme.more.parent().addClass('hidden');\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t},\n\tadd_row: function(data) {\n\t\tvar me = frappe.team_updates;\n\n\t\tdata.by = frappe.user.full_name(data.sender);\n\t\tdata.avatar = frappe.avatar(data.sender);\n\t\tdata.when = comment_when(data.creation);\n\n\t\tvar date = frappe.datetime.str_to_obj(data.creation);\n\t\tvar last = me.last_feed_date;\n\n\t\tif((last && frappe.datetime.obj_to_str(last) != frappe.datetime.obj_to_str(date)) || (!last)) {\n\t\t\tvar diff = frappe.datetime.get_day_diff(frappe.datetime.get_today(), frappe.datetime.obj_to_str(date));\n\t\t\tvar pdate;\n\t\t\tif(diff < 1) {\n\t\t\t\tpdate = 'Today';\n\t\t\t} else if(diff < 2) {\n\t\t\t\tpdate = 'Yesterday';\n\t\t\t} else {\n\t\t\t\tpdate = frappe.datetime.global_date_format(date);\n\t\t\t}\n\t\t\tdata.date_sep = pdate;\n\t\t\tdata.date_class = pdate=='Today' ? \"date-indicator blue\" : \"date-indicator\";\n\t\t} else {\n\t\t\tdata.date_sep = null;\n\t\t\tdata.date_class = \"\";\n\t\t}\n\t\tme.last_feed_date = date;\n\n\t\t$(frappe.render_template('team_update_row', data)).appendTo(me.body)\n\t}\n}","title":"Team Updates","restrict_to_domain":null,"modified":"2017-01-31 11:25:01.983200","content":null,"idx":0,"parenttype":null,"page_name":"team-updates","docstatus":0,"parentfield":null}]}