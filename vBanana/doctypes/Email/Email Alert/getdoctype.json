{"docs":[{"allow_copy":0.0,"allow_guest_to_view":0.0,"allow_import":0.0,"allow_rename":1.0,"autoname":"Prompt","beta":0.0,"creation":"2014-07-11 17:18:09.923399","custom":0.0,"docstatus":0.0,"doctype":"DocType","document_type":"System","editable_grid":0.0,"engine":"InnoDB","fields":[{"allow_bulk_edit":0.0,"allow_on_submit":0.0,"bold":0.0,"collapsible":0.0,"columns":0.0,"default":"1","fieldname":"enabled","fieldtype":"Check","hidden":0.0,"ignore_user_permissions":0.0,"ignore_xss_filter":0.0,"in_filter":0.0,"in_global_search":0.0,"in_list_view":0.0,"in_standard_filter":0.0,"label":"Enabled","length":0.0,"no_copy":0.0,"permlevel":0.0,"print_hide":0.0,"print_hide_if_no_value":0.0,"read_only":0.0,"remember_last_selected_value":0.0,"report_hide":0.0,"reqd":0.0,"search_index":0.0,"set_only_once":0.0,"unique":0.0},{"allow_bulk_edit":0.0,"allow_on_submit":0.0,"bold":0.0,"collapsible":0.0,"columns":0.0,"fieldname":"filters","fieldtype":"Section Break","hidden":0.0,"ignore_user_permissions":0.0,"ignore_xss_filter":0.0,"in_filter":0.0,"in_global_search":0.0,"in_list_view":0.0,"in_standard_filter":0.0,"label":"Filters","length":0.0,"no_copy":0.0,"permlevel":0.0,"print_hide":0.0,"print_hide_if_no_value":0.0,"read_only":0.0,"remember_last_selected_value":0.0,"report_hide":0.0,"reqd":0.0,"search_index":0.0,"set_only_once":0.0,"unique":0.0},{"allow_bulk_edit":0.0,"allow_on_submit":0.0,"bold":0.0,"collapsible":0.0,"columns":0.0,"description":"To add dynamic subject, use jinja tags like\n\n\u003cdiv\u003e\u003cpre\u003e\u003ccode\u003e{{ doc.name }} Delivered\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","fieldname":"subject","fieldtype":"Data","hidden":0.0,"ignore_user_permissions":0.0,"ignore_xss_filter":1.0,"in_filter":0.0,"in_global_search":0.0,"in_list_view":1.0,"in_standard_filter":0.0,"label":"Subject","length":0.0,"no_copy":0.0,"permlevel":0.0,"print_hide":0.0,"print_hide_if_no_value":0.0,"read_only":0.0,"remember_last_selected_value":0.0,"report_hide":0.0,"reqd":1.0,"search_index":0.0,"set_only_once":0.0,"unique":0.0},{"allow_bulk_edit":0.0,"allow_on_submit":0.0,"bold":0.0,"collapsible":0.0,"columns":0.0,"fieldname":"document_type","fieldtype":"Link","hidden":0.0,"ignore_user_permissions":0.0,"ignore_xss_filter":0.0,"in_filter":0.0,"in_global_search":0.0,"in_list_view":1.0,"in_standard_filter":1.0,"label":"Document Type","length":0.0,"no_copy":0.0,"options":"DocType","permlevel":0.0,"print_hide":0.0,"print_hide_if_no_value":0.0,"read_only":0.0,"remember_last_selected_value":0.0,"report_hide":0.0,"reqd":1.0,"search_index":1.0,"set_only_once":0.0,"unique":0.0},{"allow_bulk_edit":0.0,"allow_on_submit":0.0,"bold":0.0,"collapsible":0.0,"columns":0.0,"fieldname":"is_standard","fieldtype":"Check","hidden":0.0,"ignore_user_permissions":0.0,"ignore_xss_filter":0.0,"in_filter":0.0,"in_global_search":0.0,"in_list_view":0.0,"in_standard_filter":0.0,"label":"Is Standard","length":0.0,"no_copy":0.0,"permlevel":0.0,"precision":"","print_hide":0.0,"print_hide_if_no_value":0.0,"read_only":0.0,"remember_last_selected_value":0.0,"report_hide":0.0,"reqd":0.0,"search_index":0.0,"set_only_once":0.0,"unique":0.0},{"allow_bulk_edit":0.0,"allow_on_submit":0.0,"bold":0.0,"collapsible":0.0,"columns":0.0,"depends_on":"is_standard","fieldname":"module","fieldtype":"Link","hidden":0.0,"ignore_user_permissions":0.0,"ignore_xss_filter":0.0,"in_filter":0.0,"in_global_search":0.0,"in_list_view":0.0,"in_standard_filter":1.0,"label":"Module","length":0.0,"no_copy":0.0,"options":"Module Def","permlevel":0.0,"precision":"","print_hide":0.0,"print_hide_if_no_value":0.0,"read_only":0.0,"remember_last_selected_value":0.0,"report_hide":0.0,"reqd":0.0,"search_index":0.0,"set_only_once":0.0,"unique":0.0},{"allow_bulk_edit":0.0,"allow_on_submit":0.0,"bold":0.0,"collapsible":0.0,"columns":0.0,"fieldname":"col_break_1","fieldtype":"Column Break","hidden":0.0,"ignore_user_permissions":0.0,"ignore_xss_filter":0.0,"in_filter":0.0,"in_global_search":0.0,"in_list_view":0.0,"in_standard_filter":0.0,"length":0.0,"no_copy":0.0,"permlevel":0.0,"precision":"","print_hide":0.0,"print_hide_if_no_value":0.0,"read_only":0.0,"remember_last_selected_value":0.0,"report_hide":0.0,"reqd":0.0,"search_index":0.0,"set_only_once":0.0,"unique":0.0},{"allow_bulk_edit":0.0,"allow_on_submit":0.0,"bold":0.0,"collapsible":0.0,"columns":0.0,"fieldname":"event","fieldtype":"Select","hidden":0.0,"ignore_user_permissions":0.0,"ignore_xss_filter":0.0,"in_filter":0.0,"in_global_search":0.0,"in_list_view":1.0,"in_standard_filter":0.0,"label":"Send Alert On","length":0.0,"no_copy":0.0,"options":"\nNew\nSave\nSubmit\nCancel\nDays After\nDays Before\nValue Change\nMethod\nCustom","permlevel":0.0,"print_hide":0.0,"print_hide_if_no_value":0.0,"read_only":0.0,"remember_last_selected_value":0.0,"report_hide":0.0,"reqd":1.0,"search_index":1.0,"set_only_once":0.0,"unique":0.0},{"allow_bulk_edit":0.0,"allow_on_submit":0.0,"bold":0.0,"collapsible":0.0,"columns":0.0,"depends_on":"eval:doc.event\u003d\u003d\u0027Method\u0027","description":"Trigger on valid methods like \"before_insert\", \"after_update\", etc (will depend on the DocType selected)","fieldname":"method","fieldtype":"Data","hidden":0.0,"ignore_user_permissions":0.0,"ignore_xss_filter":0.0,"in_filter":0.0,"in_global_search":0.0,"in_list_view":0.0,"in_standard_filter":0.0,"label":"Trigger Method","length":0.0,"no_copy":0.0,"permlevel":0.0,"precision":"","print_hide":0.0,"print_hide_if_no_value":0.0,"read_only":0.0,"remember_last_selected_value":0.0,"report_hide":0.0,"reqd":0.0,"search_index":0.0,"set_only_once":0.0,"unique":0.0},{"allow_bulk_edit":0.0,"allow_on_submit":0.0,"bold":0.0,"collapsible":0.0,"columns":0.0,"depends_on":"eval:doc.event\u003d\u003d\"Days After\" || doc.event\u003d\u003d\"Days Before\"","description":"Send alert if date matches this field\u0027s value","fieldname":"date_changed","fieldtype":"Select","hidden":0.0,"ignore_user_permissions":0.0,"ignore_xss_filter":0.0,"in_filter":0.0,"in_global_search":0.0,"in_list_view":0.0,"in_standard_filter":0.0,"label":"Reference Date","length":0.0,"no_copy":0.0,"permlevel":0.0,"print_hide":0.0,"print_hide_if_no_value":0.0,"read_only":0.0,"remember_last_selected_value":0.0,"report_hide":0.0,"reqd":0.0,"search_index":0.0,"set_only_once":0.0,"unique":0.0},{"allow_bulk_edit":0.0,"allow_on_submit":0.0,"bold":0.0,"collapsible":0.0,"columns":0.0,"default":"0","depends_on":"eval:doc.event\u003d\u003d\"Days After\" || doc.event\u003d\u003d\"Days Before\"","description":"Send days before or after the reference date","fieldname":"days_in_advance","fieldtype":"Int","hidden":0.0,"ignore_user_permissions":0.0,"ignore_xss_filter":0.0,"in_filter":0.0,"in_global_search":0.0,"in_list_view":0.0,"in_standard_filter":0.0,"label":"Days Before or After","length":0.0,"no_copy":0.0,"permlevel":0.0,"print_hide":0.0,"print_hide_if_no_value":0.0,"read_only":0.0,"remember_last_selected_value":0.0,"report_hide":0.0,"reqd":0.0,"search_index":0.0,"set_only_once":0.0,"unique":0.0},{"allow_bulk_edit":0.0,"allow_on_submit":0.0,"bold":0.0,"collapsible":0.0,"columns":0.0,"depends_on":"eval:doc.event\u003d\u003d\"Value Change\"","description":"Send alert if this field\u0027s value changes","fieldname":"value_changed","fieldtype":"Select","hidden":0.0,"ignore_user_permissions":0.0,"ignore_xss_filter":0.0,"in_filter":0.0,"in_global_search":0.0,"in_list_view":0.0,"in_standard_filter":0.0,"label":"Value Changed","length":0.0,"no_copy":0.0,"permlevel":0.0,"print_hide":0.0,"print_hide_if_no_value":0.0,"read_only":0.0,"remember_last_selected_value":0.0,"report_hide":0.0,"reqd":0.0,"search_index":0.0,"set_only_once":0.0,"unique":0.0},{"allow_bulk_edit":0.0,"allow_on_submit":0.0,"bold":0.0,"collapsible":0.0,"columns":0.0,"fieldname":"section_break_9","fieldtype":"Section Break","hidden":0.0,"ignore_user_permissions":0.0,"ignore_xss_filter":0.0,"in_filter":0.0,"in_global_search":0.0,"in_list_view":0.0,"in_standard_filter":0.0,"length":0.0,"no_copy":0.0,"permlevel":0.0,"precision":"","print_hide":0.0,"print_hide_if_no_value":0.0,"read_only":0.0,"remember_last_selected_value":0.0,"report_hide":0.0,"reqd":0.0,"search_index":0.0,"set_only_once":0.0,"unique":0.0},{"allow_bulk_edit":0.0,"allow_on_submit":0.0,"bold":0.0,"collapsible":0.0,"columns":0.0,"depends_on":"","description":"Optional: The alert will be sent if this expression is true","fieldname":"condition","fieldtype":"Code","hidden":0.0,"ignore_user_permissions":0.0,"ignore_xss_filter":1.0,"in_filter":0.0,"in_global_search":0.0,"in_list_view":1.0,"in_standard_filter":0.0,"label":"Condition","length":0.0,"no_copy":0.0,"permlevel":0.0,"print_hide":0.0,"print_hide_if_no_value":0.0,"read_only":0.0,"remember_last_selected_value":0.0,"report_hide":0.0,"reqd":0.0,"search_index":0.0,"set_only_once":0.0,"unique":0.0},{"allow_bulk_edit":0.0,"allow_on_submit":0.0,"bold":0.0,"collapsible":0.0,"columns":0.0,"fieldname":"column_break_6","fieldtype":"Column Break","hidden":0.0,"ignore_user_permissions":0.0,"ignore_xss_filter":0.0,"in_filter":0.0,"in_global_search":0.0,"in_list_view":0.0,"in_standard_filter":0.0,"length":0.0,"no_copy":0.0,"permlevel":0.0,"print_hide":0.0,"print_hide_if_no_value":0.0,"read_only":0.0,"remember_last_selected_value":0.0,"report_hide":0.0,"reqd":0.0,"search_index":0.0,"set_only_once":0.0,"unique":0.0},{"allow_bulk_edit":0.0,"allow_on_submit":0.0,"bold":0.0,"collapsible":0.0,"columns":0.0,"fieldname":"html_7","fieldtype":"HTML","hidden":0.0,"ignore_user_permissions":0.0,"ignore_xss_filter":0.0,"in_filter":0.0,"in_global_search":0.0,"in_list_view":0.0,"in_standard_filter":0.0,"length":0.0,"no_copy":0.0,"options":"\u003cp\u003e\u003cstrong\u003eCondition Examples:\u003c/strong\u003e\u003c/p\u003e\n\u003cpre\u003edoc.status\u003d\u003d\"Open\"\ndoc.due_date\u003d\u003dnowdate()\ndoc.total \u0026gt; 40000\n\u003c/pre\u003e\n\u003cp\u003e\u003cstrong\u003eHints:\u003c/strong\u003e\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003eTo check for an event every day, select \"Date Change\" in Event\u003c/li\u003e\n\u003cli\u003eTo send an alert if a particular value changes, select \"Value Change\"\u003c/li\u003e\n\u003c/ol\u003e","permlevel":0.0,"print_hide":0.0,"print_hide_if_no_value":0.0,"read_only":0.0,"remember_last_selected_value":0.0,"report_hide":0.0,"reqd":0.0,"search_index":0.0,"set_only_once":0.0,"unique":0.0},{"allow_bulk_edit":0.0,"allow_on_submit":0.0,"bold":0.0,"collapsible":1.0,"columns":0.0,"fieldname":"property_section","fieldtype":"Section Break","hidden":0.0,"ignore_user_permissions":0.0,"ignore_xss_filter":0.0,"in_filter":0.0,"in_global_search":0.0,"in_list_view":0.0,"in_standard_filter":0.0,"label":"Set Property After Alert","length":0.0,"no_copy":0.0,"permlevel":0.0,"precision":"","print_hide":0.0,"print_hide_if_no_value":0.0,"read_only":0.0,"remember_last_selected_value":0.0,"report_hide":0.0,"reqd":0.0,"search_index":0.0,"set_only_once":0.0,"unique":0.0},{"allow_bulk_edit":0.0,"allow_on_submit":0.0,"bold":0.0,"collapsible":0.0,"columns":0.0,"fieldname":"set_property_after_alert","fieldtype":"Select","hidden":0.0,"ignore_user_permissions":0.0,"ignore_xss_filter":0.0,"in_filter":0.0,"in_global_search":0.0,"in_list_view":0.0,"in_standard_filter":0.0,"label":"Set Property After Alert","length":0.0,"no_copy":0.0,"permlevel":0.0,"precision":"","print_hide":0.0,"print_hide_if_no_value":0.0,"read_only":0.0,"remember_last_selected_value":0.0,"report_hide":0.0,"reqd":0.0,"search_index":0.0,"set_only_once":0.0,"unique":0.0},{"allow_bulk_edit":0.0,"allow_on_submit":0.0,"bold":0.0,"collapsible":0.0,"columns":0.0,"fieldname":"property_value","fieldtype":"Data","hidden":0.0,"ignore_user_permissions":0.0,"ignore_xss_filter":0.0,"in_filter":0.0,"in_global_search":0.0,"in_list_view":0.0,"in_standard_filter":0.0,"label":"Value To Be Set","length":0.0,"no_copy":0.0,"permlevel":0.0,"precision":"","print_hide":0.0,"print_hide_if_no_value":0.0,"read_only":0.0,"remember_last_selected_value":0.0,"report_hide":0.0,"reqd":0.0,"search_index":0.0,"set_only_once":0.0,"unique":0.0},{"allow_bulk_edit":0.0,"allow_on_submit":0.0,"bold":0.0,"collapsible":0.0,"columns":0.0,"fieldname":"column_break_5","fieldtype":"Section Break","hidden":0.0,"ignore_user_permissions":0.0,"ignore_xss_filter":0.0,"in_filter":0.0,"in_global_search":0.0,"in_list_view":0.0,"in_standard_filter":0.0,"label":"Recipients","length":0.0,"no_copy":0.0,"permlevel":0.0,"print_hide":0.0,"print_hide_if_no_value":0.0,"read_only":0.0,"remember_last_selected_value":0.0,"report_hide":0.0,"reqd":0.0,"search_index":0.0,"set_only_once":0.0,"unique":0.0},{"allow_bulk_edit":0.0,"allow_on_submit":0.0,"bold":0.0,"collapsible":0.0,"columns":0.0,"fieldname":"recipients","fieldtype":"Table","hidden":0.0,"ignore_user_permissions":0.0,"ignore_xss_filter":0.0,"in_filter":0.0,"in_global_search":0.0,"in_list_view":0.0,"in_standard_filter":0.0,"label":"Recipients","length":0.0,"no_copy":0.0,"options":"Email Alert Recipient","permlevel":0.0,"print_hide":0.0,"print_hide_if_no_value":0.0,"read_only":0.0,"remember_last_selected_value":0.0,"report_hide":0.0,"reqd":1.0,"search_index":0.0,"set_only_once":0.0,"unique":0.0},{"allow_bulk_edit":0.0,"allow_on_submit":0.0,"bold":0.0,"collapsible":0.0,"columns":0.0,"fieldname":"message_sb","fieldtype":"Section Break","hidden":0.0,"ignore_user_permissions":0.0,"ignore_xss_filter":0.0,"in_filter":0.0,"in_global_search":0.0,"in_list_view":0.0,"in_standard_filter":0.0,"label":"Message","length":0.0,"no_copy":0.0,"permlevel":0.0,"print_hide":0.0,"print_hide_if_no_value":0.0,"read_only":0.0,"remember_last_selected_value":0.0,"report_hide":0.0,"reqd":0.0,"search_index":0.0,"set_only_once":0.0,"unique":0.0},{"allow_bulk_edit":0.0,"allow_on_submit":0.0,"bold":0.0,"collapsible":0.0,"columns":0.0,"default":"Add your message here","depends_on":"","fieldname":"message","fieldtype":"Code","hidden":0.0,"ignore_user_permissions":0.0,"ignore_xss_filter":1.0,"in_filter":0.0,"in_global_search":0.0,"in_list_view":0.0,"in_standard_filter":0.0,"label":"Message","length":0.0,"no_copy":0.0,"permlevel":0.0,"print_hide":0.0,"print_hide_if_no_value":0.0,"read_only":0.0,"remember_last_selected_value":0.0,"report_hide":0.0,"reqd":0.0,"search_index":0.0,"set_only_once":0.0,"unique":0.0},{"allow_bulk_edit":0.0,"allow_on_submit":0.0,"bold":0.0,"collapsible":0.0,"columns":0.0,"fieldname":"message_examples","fieldtype":"HTML","hidden":0.0,"ignore_user_permissions":0.0,"ignore_xss_filter":0.0,"in_filter":0.0,"in_global_search":0.0,"in_list_view":0.0,"in_standard_filter":0.0,"label":"Message Examples","length":0.0,"no_copy":0.0,"options":"\u003ch5\u003eMessage Example\u003c/h5\u003e\n\n\u003cpre\u003e\u0026lt;h3\u0026gt;Order Overdue\u0026lt;/h3\u0026gt;\n\n\u0026lt;p\u0026gt;Transaction {{ doc.name }} has exceeded Due Date. Please take necessary action.\u0026lt;/p\u0026gt;\n\n\u0026lt;!-- show last comment --\u0026gt;\n{% if comments %}\nLast comment: {{ comments[-1].comment }} by {{ comments[-1].by }}\n{% endif %}\n\n\u0026lt;h4\u0026gt;Details\u0026lt;/h4\u0026gt;\n\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;Customer: {{ doc.customer }}\n\u0026lt;li\u0026gt;Amount: {{ doc.total_amount }}\n\u0026lt;/ul\u0026gt;\n\u003c/pre\u003e","permlevel":0.0,"print_hide":0.0,"print_hide_if_no_value":0.0,"read_only":0.0,"remember_last_selected_value":0.0,"report_hide":0.0,"reqd":0.0,"search_index":0.0,"set_only_once":0.0,"unique":0.0},{"allow_bulk_edit":0.0,"allow_on_submit":0.0,"bold":0.0,"collapsible":0.0,"columns":0.0,"fieldname":"view_properties","fieldtype":"Button","hidden":0.0,"ignore_user_permissions":0.0,"ignore_xss_filter":0.0,"in_filter":0.0,"in_global_search":0.0,"in_list_view":0.0,"in_standard_filter":0.0,"label":"View Properties (via Customize Form)","length":0.0,"no_copy":0.0,"permlevel":0.0,"precision":"","print_hide":0.0,"print_hide_if_no_value":0.0,"read_only":0.0,"remember_last_selected_value":0.0,"report_hide":0.0,"reqd":0.0,"search_index":0.0,"set_only_once":0.0,"unique":0.0},{"allow_bulk_edit":0.0,"allow_on_submit":0.0,"bold":0.0,"collapsible":1.0,"collapsible_depends_on":"attach_print","columns":0.0,"fieldname":"column_break_25","fieldtype":"Section Break","hidden":0.0,"ignore_user_permissions":0.0,"ignore_xss_filter":0.0,"in_filter":0.0,"in_global_search":0.0,"in_list_view":0.0,"in_standard_filter":0.0,"label":"Print Settings","length":0.0,"no_copy":0.0,"permlevel":0.0,"precision":"","print_hide":0.0,"print_hide_if_no_value":0.0,"read_only":0.0,"remember_last_selected_value":0.0,"report_hide":0.0,"reqd":0.0,"search_index":0.0,"set_only_once":0.0,"unique":0.0},{"allow_bulk_edit":0.0,"allow_on_submit":0.0,"bold":0.0,"collapsible":0.0,"columns":0.0,"fieldname":"attach_print","fieldtype":"Check","hidden":0.0,"ignore_user_permissions":0.0,"ignore_xss_filter":0.0,"in_filter":0.0,"in_global_search":0.0,"in_list_view":0.0,"in_standard_filter":0.0,"label":"Attach Print","length":0.0,"no_copy":0.0,"permlevel":0.0,"precision":"","print_hide":0.0,"print_hide_if_no_value":0.0,"read_only":0.0,"remember_last_selected_value":0.0,"report_hide":0.0,"reqd":0.0,"search_index":0.0,"set_only_once":0.0,"unique":0.0},{"allow_bulk_edit":0.0,"allow_on_submit":0.0,"bold":0.0,"collapsible":0.0,"columns":0.0,"depends_on":"attach_print","fieldname":"print_format","fieldtype":"Link","hidden":0.0,"ignore_user_permissions":0.0,"ignore_xss_filter":0.0,"in_filter":0.0,"in_global_search":0.0,"in_list_view":0.0,"in_standard_filter":0.0,"label":"Print Format","length":0.0,"no_copy":0.0,"options":"Print Format","permlevel":0.0,"precision":"","print_hide":0.0,"print_hide_if_no_value":0.0,"read_only":0.0,"remember_last_selected_value":0.0,"report_hide":0.0,"reqd":0.0,"search_index":0.0,"set_only_once":0.0,"unique":0.0}],"has_web_view":0.0,"hide_heading":0.0,"hide_toolbar":0.0,"icon":"fa fa-envelope","idx":0.0,"image_view":0.0,"in_create":0.0,"is_submittable":0.0,"issingle":0.0,"istable":0.0,"max_attachments":0.0,"menu_index":0.0,"modified":"2017-09-26 20:10:00.061780","modified_by":"Administrator","module":"Email","name":"Email Alert","name_case":"","owner":"Administrator","permissions":[{"amend":0.0,"apply_user_permissions":0.0,"cancel":0.0,"create":1.0,"delete":1.0,"email":0.0,"export":1.0,"if_owner":0.0,"import":0.0,"permlevel":0.0,"print":0.0,"read":1.0,"report":1.0,"role":"System Manager","set_user_permissions":0.0,"share":1.0,"submit":0.0,"write":1.0}],"quick_entry":0.0,"read_only":0.0,"read_only_onload":0.0,"show_name_in_global_search":0.0,"sort_field":"modified","sort_order":"DESC","title_field":"subject","track_changes":1.0,"track_seen":0.0,"__js":"frappe.email_alert \u003d {\r\n\tsetup_fieldname_select: function(frm) {\r\n\t\t// get the doctype to update fields\r\n\t\tif(!frm.doc.document_type) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tfrappe.model.with_doctype(frm.doc.document_type, function() {\r\n\t\t\tlet get_select_options \u003d function(df) {\r\n\t\t\t\treturn {value: df.fieldname, label: df.fieldname + \" (\" + __(df.label) + \")\"};\r\n\t\t\t}\r\n\r\n\t\t\tlet get_date_change_options \u003d function() {\r\n\t\t\t\tlet date_options \u003d $.map(fields, function(d) {\r\n\t\t\t\t\treturn (d.fieldtype\u003d\u003d\"Date\" || d.fieldtype\u003d\u003d\"Datetime\")?\r\n\t\t\t\t\t\tget_select_options(d) : null;\r\n\t\t\t\t});\r\n\t\t\t\t// append creation and modified date to Date Change field\r\n\t\t\t\treturn date_options.concat([\r\n\t\t\t\t\t{ value: \"creation\", label: `creation (${__(\u0027Created On\u0027)})` },\r\n\t\t\t\t\t{ value: \"modified\", label: `modified (${__(\u0027Last Modified Date\u0027)})` }\r\n\t\t\t\t]);\r\n\t\t\t}\r\n\r\n\t\t\tlet fields \u003d frappe.get_doc(\"DocType\", frm.doc.document_type).fields;\r\n\t\t\tlet options \u003d $.map(fields,\r\n\t\t\t\tfunction(d) { return in_list(frappe.model.no_value_type, d.fieldtype) ?\r\n\t\t\t\t\tnull : get_select_options(d); });\r\n\r\n\t\t\t// set value changed options\r\n\t\t\tfrm.set_df_property(\"value_changed\", \"options\", [\"\"].concat(options));\r\n\t\t\tfrm.set_df_property(\"set_property_after_alert\", \"options\", [\"\"].concat(options));\r\n\r\n\t\t\t// set date changed options\r\n\t\t\tfrm.set_df_property(\"date_changed\", \"options\", get_date_change_options());\r\n\r\n\t\t\tlet email_fields \u003d $.map(fields,\r\n\t\t\t\tfunction(d) { return (d.options \u003d\u003d \"Email\" ||\r\n\t\t\t\t\t(d.options\u003d\u003d\u0027User\u0027 \u0026\u0026 d.fieldtype\u003d\u003d\u0027Link\u0027)) ?\r\n\t\t\t\t\tget_select_options(d) : null; });\r\n\r\n\t\t\t// set email recipient options\r\n\t\t\tfrappe.meta.get_docfield(\"Email Alert Recipient\", \"email_by_document_field\",\r\n\t\t\t\t// set first option as blank to allow email alert not to be defaulted to the owner\r\n\t\t\t\tfrm.doc.name).options \u003d [\"\"].concat([\"owner\"].concat(email_fields));\r\n\r\n\t\t\tfrm.fields_dict.recipients.grid.refresh();\r\n\t\t});\r\n\t}\r\n}\r\n\r\nfrappe.ui.form.on(\"Email Alert\", {\r\n\tonload: function(frm) {\r\n\t\tfrm.set_query(\"document_type\", function() {\r\n\t\t\treturn {\r\n\t\t\t\t\"filters\": {\r\n\t\t\t\t\t\"istable\": 0\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t\tfrm.set_query(\"print_format\", function() {\r\n\t\t\treturn {\r\n\t\t\t\t\"filters\": {\r\n\t\t\t\t\t\"doc_type\": frm.doc.document_type\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t},\r\n\trefresh: function(frm) {\r\n\t\tfrappe.email_alert.setup_fieldname_select(frm);\r\n\t\tfrm.get_field(\"is_standard\").toggle(frappe.boot.developer_mode);\r\n\t\tfrm.trigger(\u0027event\u0027);\r\n\t},\r\n\tdocument_type: function(frm) {\r\n\t\tfrappe.email_alert.setup_fieldname_select(frm);\r\n\t},\r\n\tview_properties: function(frm) {\r\n\t\tfrappe.route_options \u003d {doc_type:frm.doc.document_type};\r\n\t\tfrappe.set_route(\"Form\", \"Customize Form\");\r\n\t},\r\n\tevent: function(frm) {\r\n\t\tif(in_list([\u0027Days Before\u0027, \u0027Days After\u0027], frm.doc.event)) {\r\n\t\t\tfrm.add_custom_button(__(\u0027Get Alerts for Today\u0027), function() {\r\n\t\t\t\tfrappe.call({\r\n\t\t\t\t\tmethod: \u0027frappe.email.doctype.email_alert.email_alert.get_documents_for_today\u0027,\r\n\t\t\t\t\targs: {\r\n\t\t\t\t\t\temail_alert: frm.doc.name\r\n\t\t\t\t\t},\r\n\t\t\t\t\tcallback: function(r) {\r\n\t\t\t\t\t\tif(r.message) {\r\n\t\t\t\t\t\t\tfrappe.msgprint(r.message);\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tfrappe.msgprint(__(\u0027No alerts for today\u0027));\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n});\r\n"},{"allow_copy":0.0,"allow_import":0.0,"allow_rename":0.0,"beta":0.0,"creation":"2014-07-11 17:19:37.037109","custom":0.0,"docstatus":0.0,"doctype":"DocType","document_type":"","editable_grid":1.0,"engine":"InnoDB","fields":[{"allow_on_submit":0.0,"bold":0.0,"collapsible":0.0,"columns":0.0,"description":"","fieldname":"email_by_document_field","fieldtype":"Select","hidden":0.0,"ignore_user_permissions":0.0,"ignore_xss_filter":0.0,"in_filter":0.0,"in_list_view":1.0,"label":"Email By Document Field","length":0.0,"no_copy":0.0,"permlevel":0.0,"print_hide":0.0,"print_hide_if_no_value":0.0,"read_only":0.0,"remember_last_selected_value":0.0,"report_hide":0.0,"reqd":0.0,"search_index":0.0,"set_only_once":0.0,"unique":0.0},{"allow_on_submit":0.0,"bold":0.0,"collapsible":0.0,"columns":0.0,"fieldname":"email_by_role","fieldtype":"Link","hidden":0.0,"ignore_user_permissions":0.0,"ignore_xss_filter":0.0,"in_filter":0.0,"in_list_view":1.0,"label":"Email By Role","length":0.0,"no_copy":0.0,"options":"Role","permlevel":0.0,"precision":"","print_hide":0.0,"print_hide_if_no_value":0.0,"read_only":0.0,"remember_last_selected_value":0.0,"report_hide":0.0,"reqd":0.0,"search_index":0.0,"set_only_once":0.0,"unique":0.0},{"allow_on_submit":0.0,"bold":0.0,"collapsible":0.0,"columns":0.0,"description":"Optional: Always send to these ids. Each Email Address on a new row","fieldname":"cc","fieldtype":"Code","hidden":0.0,"ignore_user_permissions":0.0,"ignore_xss_filter":0.0,"in_filter":0.0,"in_list_view":1.0,"label":"CC","length":0.0,"no_copy":0.0,"options":"Email","permlevel":0.0,"print_hide":0.0,"print_hide_if_no_value":0.0,"read_only":0.0,"remember_last_selected_value":0.0,"report_hide":0.0,"reqd":0.0,"search_index":0.0,"set_only_once":0.0,"unique":0.0},{"allow_on_submit":0.0,"bold":0.0,"collapsible":0.0,"columns":0.0,"description":"Expression, Optional","fieldname":"condition","fieldtype":"Data","hidden":0.0,"ignore_user_permissions":0.0,"ignore_xss_filter":0.0,"in_filter":0.0,"in_list_view":1.0,"label":"Condition","length":0.0,"no_copy":0.0,"permlevel":0.0,"print_hide":0.0,"print_hide_if_no_value":0.0,"read_only":0.0,"remember_last_selected_value":0.0,"report_hide":0.0,"reqd":0.0,"search_index":0.0,"set_only_once":0.0,"unique":0.0}],"hide_heading":0.0,"hide_toolbar":0.0,"idx":0.0,"image_view":0.0,"in_create":0.0,"in_dialog":0.0,"is_submittable":0.0,"issingle":0.0,"istable":1.0,"max_attachments":0.0,"modified":"2016-12-30 11:09:35.562857","modified_by":"Administrator","module":"Email","name":"Email Alert Recipient","name_case":"","owner":"Administrator","permissions":[],"quick_entry":1.0,"read_only":0.0,"read_only_onload":0.0,"sort_field":"modified","sort_order":"DESC","track_seen":0.0}],"user_settings":"{}"}