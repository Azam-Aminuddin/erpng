{"docs":[{"allow_copy":0.0,"allow_guest_to_view":0.0,"allow_import":0.0,"allow_rename":0.0,"beta":1.0,"creation":"2017-09-15 15:10:24.530365","custom":0.0,"docstatus":0.0,"doctype":"DocType","document_type":"","editable_grid":1.0,"engine":"InnoDB","fields":[{"allow_bulk_edit":0.0,"allow_on_submit":0.0,"bold":0.0,"collapsible":0.0,"columns":0.0,"fieldname":"restaurant_table","fieldtype":"Link","hidden":0.0,"ignore_user_permissions":0.0,"ignore_xss_filter":0.0,"in_filter":0.0,"in_global_search":0.0,"in_list_view":0.0,"in_standard_filter":0.0,"label":"Restaurant Table","length":0.0,"no_copy":0.0,"options":"Restaurant Table","permlevel":0.0,"precision":"","print_hide":0.0,"print_hide_if_no_value":0.0,"read_only":0.0,"remember_last_selected_value":0.0,"report_hide":0.0,"reqd":0.0,"search_index":0.0,"set_only_once":0.0,"unique":0.0,"doctype":"DocField","name":"312neu3krf","docstatus":0,"idx":0,"parenttype":"DocType","parentfield":"fields","parent":"Restaurant Order Entry","owner":"Administrator","modified_by":"Administrator","creation":"2017-10-25 23:36:28.617","modified":"2017-10-25 23:36:28.617"},{"allow_bulk_edit":0.0,"allow_on_submit":0.0,"bold":0.0,"collapsible":0.0,"columns":0.0,"depends_on":"restaurant_table","description":"Click Enter To Add","fieldname":"add_item","fieldtype":"Link","hidden":0.0,"ignore_user_permissions":0.0,"ignore_xss_filter":0.0,"in_filter":0.0,"in_global_search":0.0,"in_list_view":0.0,"in_standard_filter":0.0,"label":"Add Item","length":0.0,"no_copy":0.0,"options":"Item","permlevel":0.0,"precision":"","print_hide":0.0,"print_hide_if_no_value":0.0,"read_only":0.0,"remember_last_selected_value":0.0,"report_hide":0.0,"reqd":0.0,"search_index":0.0,"set_only_once":0.0,"unique":0.0,"doctype":"DocField","name":"7si3simfr3","docstatus":0,"idx":1,"parenttype":"DocType","parentfield":"fields","parent":"Restaurant Order Entry","owner":"Administrator","modified_by":"Administrator","creation":"2017-10-25 23:36:28.617","modified":"2017-10-25 23:36:28.617"},{"allow_bulk_edit":0.0,"allow_on_submit":0.0,"bold":0.0,"collapsible":0.0,"columns":0.0,"fieldname":"column_break_3","fieldtype":"Column Break","hidden":0.0,"ignore_user_permissions":0.0,"ignore_xss_filter":0.0,"in_filter":0.0,"in_global_search":0.0,"in_list_view":0.0,"in_standard_filter":0.0,"length":0.0,"no_copy":0.0,"permlevel":0.0,"precision":"","print_hide":0.0,"print_hide_if_no_value":0.0,"read_only":0.0,"remember_last_selected_value":0.0,"report_hide":0.0,"reqd":0.0,"search_index":0.0,"set_only_once":0.0,"unique":0.0,"doctype":"DocField","name":"66lpulh96k","docstatus":0,"idx":2,"parenttype":"DocType","parentfield":"fields","parent":"Restaurant Order Entry","owner":"Administrator","modified_by":"Administrator","creation":"2017-10-25 23:36:28.617","modified":"2017-10-25 23:36:28.617"},{"allow_bulk_edit":0.0,"allow_on_submit":0.0,"bold":0.0,"collapsible":0.0,"columns":0.0,"fieldname":"grand_total","fieldtype":"Currency","hidden":0.0,"ignore_user_permissions":0.0,"ignore_xss_filter":0.0,"in_filter":0.0,"in_global_search":0.0,"in_list_view":0.0,"in_standard_filter":0.0,"label":"Grand Total","length":0.0,"no_copy":0.0,"permlevel":0.0,"precision":"","print_hide":0.0,"print_hide_if_no_value":0.0,"read_only":1.0,"remember_last_selected_value":0.0,"report_hide":0.0,"reqd":0.0,"search_index":0.0,"set_only_once":0.0,"unique":0.0,"doctype":"DocField","name":"4eu1pkeh91","docstatus":0,"idx":3,"parenttype":"DocType","parentfield":"fields","parent":"Restaurant Order Entry","owner":"Administrator","modified_by":"Administrator","creation":"2017-10-25 23:36:28.617","modified":"2017-10-25 23:36:28.617"},{"allow_bulk_edit":0.0,"allow_on_submit":0.0,"bold":0.0,"collapsible":0.0,"columns":0.0,"fieldname":"last_sales_invoice","fieldtype":"Link","hidden":0.0,"ignore_user_permissions":0.0,"ignore_xss_filter":0.0,"in_filter":0.0,"in_global_search":0.0,"in_list_view":0.0,"in_standard_filter":0.0,"label":"Last Sales Invoice","length":0.0,"no_copy":0.0,"options":"Sales Invoice","permlevel":0.0,"precision":"","print_hide":0.0,"print_hide_if_no_value":0.0,"read_only":1.0,"remember_last_selected_value":0.0,"report_hide":0.0,"reqd":0.0,"search_index":0.0,"set_only_once":0.0,"unique":0.0,"doctype":"DocField","name":"b6kggugd","docstatus":0,"idx":4,"parenttype":"DocType","parentfield":"fields","parent":"Restaurant Order Entry","owner":"Administrator","modified_by":"Administrator","creation":"2017-10-25 23:36:28.617","modified":"2017-10-25 23:36:28.617"},{"allow_bulk_edit":0.0,"allow_on_submit":0.0,"bold":0.0,"collapsible":0.0,"columns":0.0,"depends_on":"restaurant_table","fieldname":"current_order","fieldtype":"Section Break","hidden":0.0,"ignore_user_permissions":0.0,"ignore_xss_filter":0.0,"in_filter":0.0,"in_global_search":0.0,"in_list_view":0.0,"in_standard_filter":0.0,"label":"Current Order","length":0.0,"no_copy":0.0,"permlevel":0.0,"precision":"","print_hide":0.0,"print_hide_if_no_value":0.0,"read_only":0.0,"remember_last_selected_value":0.0,"report_hide":0.0,"reqd":0.0,"search_index":0.0,"set_only_once":0.0,"unique":0.0,"doctype":"DocField","name":"5j8r12po1b","docstatus":0,"idx":5,"parenttype":"DocType","parentfield":"fields","parent":"Restaurant Order Entry","owner":"Administrator","modified_by":"Administrator","creation":"2017-10-25 23:36:28.617","modified":"2017-10-25 23:36:28.617"},{"allow_bulk_edit":0.0,"allow_on_submit":0.0,"bold":0.0,"collapsible":0.0,"columns":0.0,"depends_on":"restaurant_table","fieldname":"items","fieldtype":"Table","hidden":0.0,"ignore_user_permissions":0.0,"ignore_xss_filter":0.0,"in_filter":0.0,"in_global_search":0.0,"in_list_view":0.0,"in_standard_filter":0.0,"label":"Items","length":0.0,"no_copy":0.0,"options":"Restaurant Order Entry Item","permlevel":0.0,"precision":"","print_hide":0.0,"print_hide_if_no_value":0.0,"read_only":0.0,"remember_last_selected_value":0.0,"report_hide":0.0,"reqd":0.0,"search_index":0.0,"set_only_once":0.0,"unique":0.0,"doctype":"DocField","name":"q1ceedavb","docstatus":0,"idx":6,"parenttype":"DocType","parentfield":"fields","parent":"Restaurant Order Entry","owner":"Administrator","modified_by":"Administrator","creation":"2017-10-25 23:36:28.617","modified":"2017-10-25 23:36:28.617"}],"has_web_view":0.0,"hide_heading":0.0,"hide_toolbar":0.0,"idx":0.0,"image_view":0.0,"in_create":0.0,"is_submittable":0.0,"issingle":1.0,"istable":0.0,"max_attachments":0.0,"modified":"2017-10-04 17:06:20.926999","modified_by":"Administrator","module":"Restaurant","name":"Restaurant Order Entry","name_case":"","owner":"Administrator","permissions":[{"amend":0.0,"apply_user_permissions":0.0,"cancel":0.0,"create":1.0,"delete":1.0,"email":1.0,"export":0.0,"if_owner":0.0,"import":0.0,"permlevel":0.0,"print":1.0,"read":1.0,"report":0.0,"role":"Restaurant Manager","set_user_permissions":0.0,"share":1.0,"submit":0.0,"write":1.0,"doctype":"DocPerm","name":"53ne4m6tqi","docstatus":0,"idx":0,"parenttype":"DocType","parentfield":"permissions","parent":"Restaurant Order Entry","owner":"Administrator","modified_by":"Administrator","creation":"2017-10-25 23:36:28.617","modified":"2017-10-25 23:36:28.617"}],"quick_entry":1.0,"read_only":0.0,"read_only_onload":0.0,"restrict_to_domain":"Hospitality","show_name_in_global_search":0.0,"sort_field":"modified","sort_order":"DESC","track_changes":1.0,"track_seen":0.0,"__js":"// Copyright (c) 2017, Frappe Technologies Pvt. Ltd. and contributors\r\n// For license information, please see license.txt\r\n\r\nfrappe.ui.form.on(\u0027Restaurant Order Entry\u0027, {\r\n\tsetup: function(frm) {\r\n\t\tlet get_item_query \u003d () \u003d\u003e {\r\n\t\t\treturn {\r\n\t\t\t\tquery: \u0027erpnext.restaurant.doctype.restaurant_order_entry.restaurant_order_entry.item_query_restaurant\u0027,\r\n\t\t\t\tfilters: {\r\n\t\t\t\t\t\u0027table\u0027: frm.doc.restaurant_table\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t};\r\n\t\tfrm.set_query(\u0027item\u0027, \u0027items\u0027, get_item_query);\r\n\t\tfrm.set_query(\u0027add_item\u0027, get_item_query);\r\n\t},\r\n\tonload_post_render: function(frm) {\r\n\t\tif(!this.item_selector) {\r\n\t\t\tthis.item_selector \u003d new erpnext.ItemSelector({\r\n\t\t\t\tfrm: frm,\r\n\t\t\t\titem_field: \u0027item\u0027,\r\n\t\t\t\titem_query: \u0027erpnext.restaurant.doctype.restaurant_order_entry.restaurant_order_entry.item_query_restaurant\u0027,\r\n\t\t\t\tget_filters: () \u003d\u003e {\r\n\t\t\t\t\treturn {table: frm.doc.restaurant_table};\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\tlet $input \u003d frm.get_field(\u0027add_item\u0027).$input;\r\n\r\n\t\t$input.on(\u0027keyup\u0027, function(e) {\r\n\t\t\tif (e.which\u003d\u003d\u003d13) {\r\n\t\t\t\tif (frm.clear_item_timeout) {\r\n\t\t\t\t\tclearTimeout (frm.clear_item_timeout);\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// clear the item input so user can enter a new item\r\n\t\t\t\tfrm.clear_item_timeout \u003d setTimeout (() \u003d\u003e {\r\n\t\t\t\t\tfrm.set_value(\u0027add_item\u0027, \u0027\u0027);\r\n\t\t\t\t}, 1000);\r\n\r\n\t\t\t\tlet item \u003d $input.val();\r\n\r\n\t\t\t\tif (!item) return;\r\n\r\n\t\t\t\tvar added \u003d false;\r\n\t\t\t\t(frm.doc.items || []).forEach((d) \u003d\u003e {\r\n\t\t\t\t\tif (d.item\u003d\u003d\u003ditem) {\r\n\t\t\t\t\t\td.qty +\u003d 1;\r\n\t\t\t\t\t\tadded \u003d true;\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\r\n\t\t\t\treturn frappe.run_serially([\r\n\t\t\t\t\t() \u003d\u003e {\r\n\t\t\t\t\t\tif (!added) {\r\n\t\t\t\t\t\t\treturn frm.add_child(\u0027items\u0027, {item: item, qty: 1});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\t() \u003d\u003e frm.get_field(\"items\").refresh()\r\n\t\t\t\t]);\r\n\t\t\t}\r\n\t\t});\r\n\t},\r\n\trefresh: function(frm) {\r\n\t\tfrm.disable_save();\r\n\t\tfrm.add_custom_button(__(\u0027Update\u0027), () \u003d\u003e {\r\n\t\t\treturn frm.trigger(\u0027sync\u0027);\r\n\t\t});\r\n\t\tfrm.add_custom_button(__(\u0027Clear\u0027), () \u003d\u003e {\r\n\t\t\treturn frm.trigger(\u0027clear\u0027);\r\n\t\t});\r\n\t\tfrm.add_custom_button(__(\u0027Bill\u0027), () \u003d\u003e {\r\n\t\t\treturn frm.trigger(\u0027make_invoice\u0027);\r\n\t\t});\r\n\t},\r\n\tclear: function(frm) {\r\n\t\tfrm.doc.add_item \u003d \u0027\u0027;\r\n\t\tfrm.doc.grand_total \u003d 0;\r\n\t\tfrm.doc.items \u003d [];\r\n\t\tfrm.refresh();\r\n\t\tfrm.get_field(\u0027add_item\u0027).$input.focus();\r\n\t},\r\n\trestaurant_table: function(frm) {\r\n\t\t// select the open sales order items for this table\r\n\t\tif (!frm.doc.restaurant_table) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\treturn frappe.call({\r\n\t\t\tmethod: \u0027erpnext.restaurant.doctype.restaurant_order_entry.restaurant_order_entry.get_invoice\u0027,\r\n\t\t\targs: {\r\n\t\t\t\ttable: frm.doc.restaurant_table\r\n\t\t\t},\r\n\t\t\tcallback: (r) \u003d\u003e {\r\n\t\t\t\tfrm.events.set_invoice_items(frm, r);\r\n\t\t\t}\r\n\t\t});\r\n\t},\r\n\tsync: function(frm) {\r\n\t\treturn frappe.call({\r\n\t\t\tmethod: \u0027erpnext.restaurant.doctype.restaurant_order_entry.restaurant_order_entry.sync\u0027,\r\n\t\t\targs: {\r\n\t\t\t\ttable: frm.doc.restaurant_table,\r\n\t\t\t\titems: frm.doc.items\r\n\t\t\t},\r\n\t\t\tcallback: (r) \u003d\u003e {\r\n\t\t\t\tfrm.events.set_invoice_items(frm, r);\r\n\t\t\t\tfrappe.show_alert({message: __(\u0027Saved\u0027), indicator: \u0027green\u0027});\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t},\r\n\tmake_invoice: function(frm) {\r\n\t\tfrm.trigger(\u0027sync\u0027).then(() \u003d\u003e {\r\n\t\t\tfrappe.prompt([\r\n\t\t\t\t{\r\n\t\t\t\t\tfieldname: \u0027customer\u0027,\r\n\t\t\t\t\tlabel: __(\u0027Customer\u0027),\r\n\t\t\t\t\tfieldtype: \u0027Link\u0027,\r\n\t\t\t\t\treqd: 1,\r\n\t\t\t\t\toptions: \u0027Customer\u0027,\r\n\t\t\t\t\t\u0027default\u0027: frm.invoice.customer\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\tfieldname: \u0027mode_of_payment\u0027,\r\n\t\t\t\t\tlabel: __(\u0027Mode of Payment\u0027),\r\n\t\t\t\t\tfieldtype: \u0027Link\u0027,\r\n\t\t\t\t\treqd: 1,\r\n\t\t\t\t\toptions: \u0027Mode of Payment\u0027,\r\n\t\t\t\t\t\u0027default\u0027: frm.mode_of_payment || \u0027\u0027\r\n\t\t\t\t}\r\n\t\t\t], (data) \u003d\u003e {\r\n\t\t\t\t// cache this for next entry\r\n\t\t\t\tfrm.mode_of_payment \u003d data.mode_of_payment;\r\n\t\t\t\treturn frappe.call({\r\n\t\t\t\t\tmethod: \u0027erpnext.restaurant.doctype.restaurant_order_entry.restaurant_order_entry.make_invoice\u0027,\r\n\t\t\t\t\targs: {\r\n\t\t\t\t\t\ttable: frm.doc.restaurant_table,\r\n\t\t\t\t\t\tcustomer: data.customer,\r\n\t\t\t\t\t\tmode_of_payment: data.mode_of_payment\r\n\t\t\t\t\t},\r\n\t\t\t\t\tcallback: (r) \u003d\u003e {\r\n\t\t\t\t\t\tfrm.set_value(\u0027last_sales_invoice\u0027, r.message);\r\n\t\t\t\t\t\tfrm.trigger(\u0027clear\u0027);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\t__(\"Select Customer\"));\r\n\t\t});\r\n\t},\r\n\tset_invoice_items: function(frm, r) {\r\n\t\tlet invoice \u003d r.message;\r\n\t\tfrm.doc.items \u003d [];\r\n\t\t(invoice.items || []).forEach((d) \u003d\u003e {\r\n\t\t\tfrm.add_child(\u0027items\u0027, {item: d.item_code, qty: d.qty, rate: d.rate});\r\n\t\t});\r\n\t\tfrm.set_value(\u0027grand_total\u0027, invoice.grand_total);\r\n\t\tfrm.set_value(\u0027last_sales_invoice\u0027, invoice.name);\r\n\t\tfrm.invoice \u003d invoice;\r\n\t\tfrm.refresh();\r\n\t}\r\n});\r\n"},{"allow_copy":0.0,"allow_guest_to_view":0.0,"allow_import":0.0,"allow_rename":0.0,"beta":0.0,"creation":"2017-09-15 15:11:50.313241","custom":0.0,"docstatus":0.0,"doctype":"DocType","document_type":"","editable_grid":1.0,"engine":"InnoDB","fields":[{"allow_bulk_edit":0.0,"allow_on_submit":0.0,"bold":0.0,"collapsible":0.0,"columns":0.0,"fieldname":"item","fieldtype":"Link","hidden":0.0,"ignore_user_permissions":0.0,"ignore_xss_filter":0.0,"in_filter":0.0,"in_global_search":0.0,"in_list_view":1.0,"in_standard_filter":0.0,"label":"Item","length":0.0,"no_copy":0.0,"options":"Item","permlevel":0.0,"precision":"","print_hide":0.0,"print_hide_if_no_value":0.0,"read_only":0.0,"remember_last_selected_value":0.0,"report_hide":0.0,"reqd":1.0,"search_index":0.0,"set_only_once":0.0,"unique":0.0,"doctype":"DocField","name":"7t99un514s","docstatus":0,"idx":0,"parenttype":"DocType","parentfield":"fields","parent":"Restaurant Order Entry Item","owner":"Administrator","modified_by":"Administrator","creation":"2017-10-25 23:36:28.617","modified":"2017-10-25 23:36:28.617"},{"allow_bulk_edit":0.0,"allow_on_submit":0.0,"bold":0.0,"collapsible":0.0,"columns":0.0,"fieldname":"qty","fieldtype":"Int","hidden":0.0,"ignore_user_permissions":0.0,"ignore_xss_filter":0.0,"in_filter":0.0,"in_global_search":0.0,"in_list_view":1.0,"in_standard_filter":0.0,"label":"Qty","length":0.0,"no_copy":0.0,"permlevel":0.0,"precision":"","print_hide":0.0,"print_hide_if_no_value":0.0,"read_only":0.0,"remember_last_selected_value":0.0,"report_hide":0.0,"reqd":1.0,"search_index":0.0,"set_only_once":0.0,"unique":0.0,"doctype":"DocField","name":"7h5vd6i6pn","docstatus":0,"idx":1,"parenttype":"DocType","parentfield":"fields","parent":"Restaurant Order Entry Item","owner":"Administrator","modified_by":"Administrator","creation":"2017-10-25 23:36:28.617","modified":"2017-10-25 23:36:28.617"},{"allow_bulk_edit":0.0,"allow_on_submit":0.0,"bold":0.0,"collapsible":0.0,"columns":0.0,"fieldname":"served","fieldtype":"Int","hidden":0.0,"ignore_user_permissions":0.0,"ignore_xss_filter":0.0,"in_filter":0.0,"in_global_search":0.0,"in_list_view":1.0,"in_standard_filter":0.0,"label":"Served","length":0.0,"no_copy":0.0,"permlevel":0.0,"precision":"","print_hide":0.0,"print_hide_if_no_value":0.0,"read_only":0.0,"remember_last_selected_value":0.0,"report_hide":0.0,"reqd":0.0,"search_index":0.0,"set_only_once":0.0,"unique":0.0,"doctype":"DocField","name":"4p6hba2h6n","docstatus":0,"idx":2,"parenttype":"DocType","parentfield":"fields","parent":"Restaurant Order Entry Item","owner":"Administrator","modified_by":"Administrator","creation":"2017-10-25 23:36:28.617","modified":"2017-10-25 23:36:28.617"},{"allow_bulk_edit":0.0,"allow_on_submit":0.0,"bold":0.0,"collapsible":0.0,"columns":0.0,"fieldname":"rate","fieldtype":"Currency","hidden":0.0,"ignore_user_permissions":0.0,"ignore_xss_filter":0.0,"in_filter":0.0,"in_global_search":0.0,"in_list_view":1.0,"in_standard_filter":0.0,"label":"Rate","length":0.0,"no_copy":0.0,"permlevel":0.0,"precision":"","print_hide":0.0,"print_hide_if_no_value":0.0,"read_only":0.0,"remember_last_selected_value":0.0,"report_hide":0.0,"reqd":0.0,"search_index":0.0,"set_only_once":0.0,"unique":0.0,"doctype":"DocField","name":"3ri2gv2n6l","docstatus":0,"idx":3,"parenttype":"DocType","parentfield":"fields","parent":"Restaurant Order Entry Item","owner":"Administrator","modified_by":"Administrator","creation":"2017-10-25 23:36:28.617","modified":"2017-10-25 23:36:28.617"}],"has_web_view":0.0,"hide_heading":0.0,"hide_toolbar":0.0,"idx":0.0,"image_view":0.0,"in_create":0.0,"is_submittable":0.0,"issingle":0.0,"istable":1.0,"max_attachments":0.0,"modified":"2017-09-21 08:39:27.232175","modified_by":"Administrator","module":"Restaurant","name":"Restaurant Order Entry Item","name_case":"","owner":"Administrator","permissions":[],"quick_entry":1.0,"read_only":0.0,"read_only_onload":0.0,"restrict_to_domain":"Hospitality","show_name_in_global_search":0.0,"sort_field":"modified","sort_order":"DESC","track_changes":1.0,"track_seen":0.0}],"user_settings":"{}"}